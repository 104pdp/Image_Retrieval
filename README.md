# Сборный проект-5  
## Поиск изображений по текстовому описанию для фотохостинга «Со Смыслом»

## Описание проекта

Данный проект посвящён разработке модели машинного обучения для фотохостинга
профессиональных фотографов **«Со Смыслом» (With Sense)**.

Задача проекта — реализовать систему, которая по **текстовому описанию сцены**
находит и ранжирует **референсные фотографии**, наиболее соответствующие этому описанию.
Проект ориентирован на использование фотографами при подборе идей, сюжетов и визуальных
референсов.

Проект реализован в виде исследовательского пайплайна и запускается **локально**
в среде Jupyter Notebook.

---

## Цель проекта

Создать и исследовать мультимодальную модель, которая:
- принимает текстовое описание изображения;
- извлекает семантические признаки текста;
- извлекает визуальные признаки изображений;
- объединяет текстовую и визуальную информацию;
- оценивает степень соответствия изображения текстовому описанию.

---

## Используемые данные

В проекте используются:
- изображения;
- текстовые описания изображений;
- экспертные оценки соответствия текста изображению (целевой признак).

Именно **экспертные оценки** используются в качестве таргета, так как они
лучше отражают частичное соответствие изображения описанию по сравнению
с бинарными пользовательскими оценками.

---

## Подход и архитектура решения

### Векторизация изображений
- Для извлечения визуальных признаков используется предобученная модель **ResNet50**.
- Классификационный слой удалён, на выходе формируются эмбеддинги размерности 2048.
- Предобработка изображений соответствует стандарту ImageNet.

### Векторизация текста
- Текст очищается и нормализуется.
- Для получения текстовых эмбеддингов используется **SentenceTransformer (all-MiniLM-L6-v2)**.
- Дополнительно проводится сравнение с классическим подходом **Word2Vec (GloVe)**.
- Качество текстовых эмбеддингов проверяется с помощью косинусного сходства.

### Объединение признаков
- Текстовые и визуальные эмбеддинги L2-нормализуются.
- Далее они объединяются в единый вектор признаков, используемый для обучения моделей.

---

## Обучение и оценка моделей

Для решения задачи были обучены и сравнены следующие модели:

- **DummyRegressor** — базовый ориентир;
- **LinearRegression** — простая линейная модель;
- **Полносвязная нейронная сеть (MLP)** на PyTorch.

Разделение данных на обучающую и валидационную выборки выполняется с помощью
`GroupShuffleSplit` с группировкой по изображению, что исключает утечку данных
между выборками.

В качестве основной метрики качества используется **MAE**.

---

## Результаты

- DummyRegressor задаёт базовый уровень качества.
- Линейная регрессия показала качество хуже базовой модели.
- Полносвязная нейронная сеть значительно превзошла базовый ориентир,
  подтвердив наличие полезного сигнала в объединённых текстовых и визуальных признаках.
- SentenceTransformer (MiniLM) показал более высокое качество по сравнению с W2V.
- Реализована финальная оценка модели на валидационной выборке.

---

## Поиск изображений по тексту

В проекте реализован демонстрационный режим поиска изображений:
- текстовый запрос преобразуется в эмбеддинг;
- для каждого изображения формируется объединённый вектор;
- нейронная сеть предсказывает степень соответствия изображения запросу;
- изображения сортируются по предсказанному скору;
- отображаются top-k наиболее релевантных результатов.

Дополнительно реализован фильтр запрещённого контента, который блокирует
вывод изображений для чувствительных запросов.

---

## Запуск проекта

Проект запускается **локально** в Jupyter Notebook.

Для запуска необходимо:
1. Установить зависимости;
2. Открыть основной ноутбук `Image_Retrieval_Zhuravel.ipynb`;
3. Последовательно выполнить все ячейки.

---

## Итоги

В рамках проекта была реализована и исследована мультимодальная система
поиска изображений по текстовому описанию. Результаты показывают, что
совместное использование визуальных и текстовых эмбеддингов позволяет
решать задачу подбора референсных изображений и может служить основой
для дальнейшего развития поисковых систем для фотохостингов.
